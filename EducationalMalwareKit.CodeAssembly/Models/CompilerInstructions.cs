using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using EducationalMalwareKit.CodeAssembly.Helpers;

namespace EducationalMalwareKit.CodeAssembly.Models
{
    public class CompilerInstructions
    {
        public const string NetVersion4 = "v4.0";
        public const string NetVersion35 = "v3.5";

        private string _netVersion = NetVersion4;

        public Assembly PayloadAssembly { get; set; }
        public List<string> ReferencedAssembliesPaths { get; set; } = new List<string>();
        public Type PayloadMainClass { get; set; }
        public string Code { get; set; }
        public bool OutputDebugFiles { get; set; }
        public bool IsDebugMode { get; set; }
        public string ExecutablePath { get; set; }
        public string EmkNamespace { get; set; }
        public string EmkMainClass { get; set; }
        public string EmbeddedEncryptionKey { get; set; }
        public string EmbeddedEncryptionSalt { get; set; }

        public string NetVersion
        {
            get { return _netVersion; }
            set
            {
                if (value.Equals(NetVersion4) || value.Equals(NetVersion35))
                {
                    _netVersion = value;
                }
                else
                {
                    throw new ArgumentException("Unsupported .NET Version");
                }
            }
        }

        public CompilerInstructions()
        {
            EmkNamespace = StringHelper.GetSudoRandomString(11);
            EmkMainClass = StringHelper.GetSudoRandomString(7);
        }
    }
}

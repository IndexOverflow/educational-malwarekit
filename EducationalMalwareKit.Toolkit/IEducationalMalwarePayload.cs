using System.Collections.Generic;

namespace EducationalMalwareKit.Toolkit
{
    public interface IEducationalMalwarePayload
    {
        /// <summary>
        /// Validate the config given from user. <see cref="PayloadConfig"/>.
        /// This method will be called before malware is assembled.
        /// </summary>
        /// <param name="config">The config provided by the user</param>
        void ValidateConfig(PayloadConfig config);
        
        /// <summary>
        /// Will be called once the executable has loaded dependencies and is running. Called once.
        /// The malware will exit if you return from this method.
        /// </summary>
        /// <param name="rawConfig">Raw config without wrapping class</param>
        void Run(Dictionary<string,string> rawConfig);
        
        /// <summary>
        /// If shutdown of executable is caught, will attempt to call this method to 
        /// allow for clean-up / gracefull shutdown.
        /// </summary>
        void OnHalt();
    }
}

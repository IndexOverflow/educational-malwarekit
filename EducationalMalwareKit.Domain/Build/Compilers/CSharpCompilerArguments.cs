using System.Collections.Generic;
using System.Text;

namespace EducationalMalwareKit.Domain.Build.Compilers
{
    public class CSharpCompilerArguments : CompilerArguments
    {
        public CSharpCompilerArguments(string buildToolsPath) : base(buildToolsPath)
        {
        }

        public override IEnumerable<string> GetSourceFileExtensions()
        {
            return new[] {".cs"};
        }

        public override string ToString(MalwareBuild malwareBuild)
        {
            var sb = new StringBuilder();
            sb
                .Append("csc")
                .Append(" /out:")
                .Append(malwareBuild.UserOptions.ExecutableName);

            malwareBuild.Manifest.Dependencies?.ForEach(x => sb.Append(" /r:\"" + x + "\""));
            malwareBuild.Manifest.Dependencies?.ForEach(x => sb.Append(" /resource:\"" + x + "\""));

            if (malwareBuild.UserOptions.Debug)
            {
                sb.Append(" /debug:full");
            }

            return sb.Append(" *.cs").ToString();
        }
    }
}
